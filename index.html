<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Canvas Tank Game</title>
    <style>canvas {
        border: 1px solid black;
    }</style>
</head>
<body>
<canvas id="gameCanvas" width="800" height="600"></canvas>
<script>const canvas = document.getElementById("gameCanvas"), ctx = canvas.getContext("2d"),
    tank = {x: 50, y: canvas.height - 50, size: 50, turretAngle: -45};
let target = {x: 0, y: 0, radius: tank.size};

function createNewTarget() {
    target.x = Math.random() * (canvas.width / 3) + (2 * canvas.width / 3), target.y = Math.random() * (canvas.height - target.radius) + target.radius
}

const projectiles = [];

function drawTank() {
    ctx.fillStyle = "red", ctx.fillRect(tank.x - tank.size / 2, tank.y - tank.size / 2, tank.size, tank.size), ctx.strokeStyle = "black", ctx.lineWidth = 5, ctx.beginPath(), ctx.moveTo(tank.x, tank.y), ctx.lineTo(tank.x + Math.cos(tank.turretAngle * Math.PI / 180) * tank.size, tank.y + Math.sin(tank.turretAngle * Math.PI / 180) * tank.size), ctx.stroke()
}

function drawTarget() {
    ctx.fillStyle = "red", ctx.beginPath(), ctx.arc(target.x, target.y, target.radius, 0, 2 * Math.PI), ctx.fill()
}

function drawProjectiles() {
    ctx.fillStyle = "black";
    for (const e of projectiles) ctx.beginPath(), ctx.arc(e.x, e.y, e.radius, 0, 2 * Math.PI), ctx.fill()
}

function updateProjectiles() {
    for (const e of projectiles) e.x += e.vx, e.y += e.vy;
    projectiles.forEach(((e, t) => {
        if (e.x > canvas.width || e.y > canvas.height || e.y < 0) return projectiles.splice(t, 1);
        const n = Math.sqrt((e.x - target.x) * (e.x - target.x) + (e.y - target.y) * (e.y - target.y));
        n <= e.radius + target.radius && (projectiles.splice(t, 1), createNewTarget())
    }))
}

function gameLoop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height), drawTank(), drawTarget(), drawProjectiles(), updateProjectiles(), requestAnimationFrame(gameLoop)
}

createNewTarget(), gameLoop(), document.addEventListener("keydown", (e => {
    "a" === e.key.toLowerCase() && (tank.turretAngle -= 5), "d" === e.key.toLowerCase() && (tank.turretAngle += 5), " " === e.key && projectiles.push({
        x: tank.x,
        y: tank.y,
        radius: 5,
        vx: 10 * Math.cos(tank.turretAngle * Math.PI / 180),
        vy: 10 * Math.sin(tank.turretAngle * Math.PI / 180)
    })
}));</script>
</body>
</html>
d
